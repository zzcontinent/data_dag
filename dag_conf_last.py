# !/usr/bin/env python
# -*- coding: utf-8 -*-
import sys

reload(sys)
sys.setdefaultencoding('utf-8')

NODES = [

 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n        insert into jff_ent_tmp.zhouxinxin_league_name_list(name_list_id, jff_name_list_id, ent_id,\n    ent_short_name, sp_id, sp_short_name, labor_sp_id, labor_sp_short_name, order_id, id_card_num,\n    interview_date, interview_status, work_card_num, work_status, entry_date, leave_date)\n    SELECT a.name_list_id, a.jff_name_list_id, a.ent_id, d.ent_short_name, c.sp_id, c.league_name,\n    e.real_b_sp_id, f.sp_short_name, a.rcrt_order_id, upper(a.id_card_num), a.intv_dt,\n    a.intv_sts, a.work_card_no, a.work_sts, a.entry_dt, a.leave_dt\n    FROM (\n    \tselect name_list_id, jff_name_list_id, ent_id, id_card_num, if(work_card_no='', null, work_card_no) as work_card_no,\n    \tintv_dt, intv_sts, work_sts, entry_dt, leave_dt, rcrt_order_id, srce_sp_id, trgt_sp_id,\n    \tif(@intv_dt=temp.intv_dt and @id_card_num=temp.id_card_num, @rank := @rank+1, @rank := 1) as rank,\n    \t@intv_dt := temp.intv_dt,  @id_card_num := temp.id_card_num\n    \tfrom (\n    \t\tselect name_list_id, jff_name_list_id, ent_id, upper(id_card_num) as id_card_num, trgt_sp_id,\n    \t\twork_card_no, intv_dt, intv_sts, work_sts, entry_dt, leave_dt, rcrt_order_id, srce_sp_id\n    \t\tfrom `ods_zxx_2.0`.name_list\n    \t\twhere is_deleted = 1\n    \t\torder by intv_dt, id_card_num, name_list_id desc\n    \t\t) temp,\n    \t\t(select @intv_dt := null, @id_card_num := null, @rank := 0) r\n    ) a\n    left join `ods_zxx_2.0`.sp_mapping b on a.srce_sp_id = b.virtual_sp_id\n    left join ods_jff.league_store c on b.real_sp_id = c.sp_id\n    left join `ods_zxx_2.0`.ent d on a.ent_id = d.ent_id\n    left join ods_jff.sp_real_coop e on a.trgt_sp_id = e.b_sp_id\n    left join ods_jff.sp f on e.real_b_sp_id = f.sp_id\n    where a.intv_dt >= c.coop_start_dt and a.rank = 1\n    and c.sp_id != 1006;\n        "}, 2: {'color': 'blue', 'name': '#meta77', 'desc': u'\u8868 | ( SELECT name_list_id jff_name_list_id ent_id id_card_num if #meta72 AS work_card_no intv_dt intv_sts work_sts entry_dt leave_dt rcrt_order_id srce_sp_id trgt_sp_id if #meta73 AS rank @intv_dt := temp.intv_dt @id_card_num := temp.id_card_num FROM #meta75 TEMP #meta76 r )'}, 3: {'color': 'blue', 'name': u'`ods_zxx_2.0`.sp_mapping', 'desc': '\xe8\xa1\xa8'}, 4: {'color': 'blue', 'name': u'ods_jff.league_store', 'desc': '\xe8\xa1\xa8'}, 5: {'color': 'blue', 'name': u'`ods_zxx_2.0`.ent', 'desc': '\xe8\xa1\xa8'}, 6: {'color': 'blue', 'name': u'ods_jff.sp_real_coop', 'desc': '\xe8\xa1\xa8'}, 7: {'color': 'blue', 'name': u'ods_jff.sp', 'desc': '\xe8\xa1\xa8'}, 8: {'color': 'blue', 'name': '#meta75', 'desc': u'\u8868 | ( SELECT name_list_id jff_name_list_id ent_id upper #meta74 AS id_card_num trgt_sp_id work_card_no intv_dt intv_sts work_sts entry_dt leave_dt rcrt_order_id srce_sp_id FROM `ods_zxx_2.0`.name_list WHERE is_deleted = 1 ORDER BY intv_dt id_card_num name_list_id DESC )'}, 9: {'color': 'blue', 'name': '#meta76', 'desc': u'\u8868 | ( SELECT @intv_dt := NULL @id_card_num := NULL @rank := 0 )'}, 10: {'color': 'blue', 'name': u'`ods_zxx_2.0`.name_list', 'desc': '\xe8\xa1\xa8'}, 11: {'color': 'orange', 'name': u'jff_name_list_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 12: {'color': 'orange', 'name': u'@intv_dt := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 13: {'color': 'orange', 'name': u'work_sts', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 14: {'color': 'orange', 'name': '#meta72', 'desc': u"\u5b57\u6bb5 | if ( work_card_no = '' NULL work_card_no ) "}, 15: {'color': 'orange', 'name': '#meta73', 'desc': u'\u5b57\u6bb5 | if ( @intv_dt = temp.intv_dt AND @id_card_num = temp.id_card_num @rank := @rank + 1 @rank := 1 ) '}, 16: {'color': 'orange', 'name': '#meta71', 'desc': u'\u5b57\u6bb5 | upper ( a.id_card_num ) '}, 17: {'color': 'orange', 'name': u'leave_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 18: {'color': 'orange', 'name': u'@id_card_num := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 19: {'color': 'orange', 'name': u'ent_short_name', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 20: {'color': 'orange', 'name': u'sp_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 21: {'color': 'orange', 'name': u'@intv_dt := temp.intv_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 22: {'color': 'orange', 'name': '#meta74', 'desc': u'\u5b57\u6bb5 | upper ( id_card_num ) '}, 23: {'color': 'orange', 'name': u'trgt_sp_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 24: {'color': 'orange', 'name': u'real_b_sp_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 25: {'color': 'orange', 'name': u'@id_card_num := temp.id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 26: {'color': 'orange', 'name': u'intv_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 27: {'color': 'orange', 'name': u'srce_sp_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 28: {'color': 'orange', 'name': u'entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 29: {'color': 'orange', 'name': u'name_list_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 30: {'color': 'orange', 'name': u'rcrt_order_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 31: {'color': 'orange', 'name': u'sp_short_name', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 32: {'color': 'orange', 'name': u'intv_sts', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 33: {'color': 'orange', 'name': u'league_name', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 34: {'color': 'orange', 'name': u'ent_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 35: {'color': 'orange', 'name': u'@rank := 0', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 36: {'color': 'pink', 'name': u'id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 37: {'color': 'pink', 'name': u'work_card_no', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 38: {'color': 'pink', 'name': u'rank', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n22 >> 36\n14 >> 37\n15 >> 38\n10 >> 11\n9 >> 12\n10 >> 13\n2 >> 14\n2 >> 15\n1 >> 16\n10 >> 17\n9 >> 18\n5 >> 19\n4 >> 20\n2 >> 21\n10 >> 22\n10 >> 23\n6 >> 24\n2 >> 25\n10 >> 26\n10 >> 27\n10 >> 28\n10 >> 29\n10 >> 30\n7 >> 31\n10 >> 32\n4 >> 33\n10 >> 34\n9 >> 35\n8 >> 10\n1 >> 3\n2 >> 9\n1 >> 2\n2 >> 8\n1 >> 7\n1 >> 5\n1 >> 6\n1 >> 4', 'title': '1 \xe7\x94\x9f\xe6\x88\x90\xe5\x8a\xa0\xe7\x9b\x9f\xe5\xba\x97\xe5\x90\x8d\xe5\x8d\x95jff_ent_tmp.zhouxinxin_league_name_list'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n            update jff_ent_tmp.zhouxinxin_league_name_list a\n    inner join (\n    \tselect ent_id, if(work_card_no='', null, work_card_no) as work_card_num, id_card_num, entry_dt as entry_date, leave_dt as leave_date,\n    \tif(@entry_dt=temp.entry_dt and @id_card_num=temp.id_card_num, @rank := @rank+1, @rank := 1) as rank,\n    \t@entry_dt := temp.entry_dt, @id_card_num := temp.id_card_num\n    \tfrom (\n    \t\tSELECT upper(id_card_num) as id_card_num, work_card_no, entry_dt, ent_id, max(leave_dt) as leave_dt, count(1) as num\n    \t\tFROM `ods_zxx_2.0`.bill_monthly_batch_import_detail\n    \t\twhere entry_dt > '1970-01-01'\n    \t\tgroup by ent_id, upper(id_card_num), work_card_no, entry_dt\n    \t\torder by ent_id, id_card_num, entry_dt, num desc\n    \t)temp,\n    \t(select @entry_dt := null, @id_card_num := null, @rank := 0) r\n    ) b on b.rank = 1 and a.id_card_num = b.id_card_num and coalesce(a.fixed_work_card_num, a.work_card_num) = b.work_card_num\n    set a.hire_status = 1\n    where a.interview_date >= '${MIN_INTV_DT}';"}, 2: {'color': 'blue', 'name': '#meta86', 'desc': u'\u8868 | ( SELECT ent_id if #meta78 AS work_card_num id_card_num entry_dt AS entry_date leave_dt AS leave_date if #meta79 AS rank @entry_dt := temp.entry_dt @id_card_num := temp.id_card_num FROM #meta84 TEMP #meta85 r )'}, 3: {'color': 'blue', 'name': '#meta84', 'desc': u"\u8868 | ( SELECT upper #meta80 AS id_card_num work_card_no entry_dt ent_id max #meta81 AS leave_dt count #meta82 AS num FROM `ods_zxx_2.0`.bill_monthly_batch_import_detail WHERE entry_dt > '1970 - 01 - 01' GROUP BY ent_id upper #meta83 work_card_no entry_dt ORDER BY ent_id id_card_num entry_dt num DESC )"}, 4: {'color': 'blue', 'name': '#meta85', 'desc': u'\u8868 | ( SELECT @entry_dt := NULL @id_card_num := NULL @rank := 0 )'}, 5: {'color': 'blue', 'name': u'`ods_zxx_2.0`.bill_monthly_batch_import_detail', 'desc': '\xe8\xa1\xa8'}, 6: {'color': 'orange', 'name': '#meta82', 'desc': u'\u5b57\u6bb5 | count ( 1 ) '}, 7: {'color': 'orange', 'name': '#meta81', 'desc': u'\u5b57\u6bb5 | max ( leave_dt ) '}, 8: {'color': 'orange', 'name': '#meta80', 'desc': u'\u5b57\u6bb5 | upper ( id_card_num ) '}, 9: {'color': 'orange', 'name': u'@id_card_num := temp.id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 10: {'color': 'orange', 'name': '#meta78', 'desc': u"\u5b57\u6bb5 | if ( work_card_no = '' NULL work_card_no ) "}, 11: {'color': 'orange', 'name': '#meta79', 'desc': u'\u5b57\u6bb5 | if ( @entry_dt = temp.entry_dt AND @id_card_num = temp.id_card_num @rank := @rank + 1 @rank := 1 ) '}, 12: {'color': 'orange', 'name': u'@id_card_num := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 13: {'color': 'orange', 'name': u'@entry_dt := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 14: {'color': 'orange', 'name': u'work_card_no', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 15: {'color': 'orange', 'name': u'entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 16: {'color': 'orange', 'name': u'@entry_dt := temp.entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 17: {'color': 'orange', 'name': u'ent_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 18: {'color': 'orange', 'name': u'@rank := 0', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 19: {'color': 'pink', 'name': u'num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 20: {'color': 'pink', 'name': u'leave_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 21: {'color': 'pink', 'name': u'id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 22: {'color': 'pink', 'name': u'work_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 23: {'color': 'pink', 'name': u'rank', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 24: {'color': 'pink', 'name': u'leave_date', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 25: {'color': 'pink', 'name': u'entry_date', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n6 >> 19\n7 >> 20\n8 >> 21\n10 >> 22\n11 >> 23\n20 >> 24\n15 >> 25\n5 >> 6\n5 >> 7\n5 >> 8\n2 >> 9\n2 >> 10\n2 >> 11\n4 >> 12\n4 >> 13\n5 >> 14\n5 >> 15\n2 >> 16\n5 >> 17\n4 >> 18\n3 >> 5\n1 >> 2\n2 >> 4\n2 >> 3', 'title': '2.1 \xe6\xa0\xb9\xe6\x8d\xae\xe5\x91\xa8\xe8\x96\xaa\xe8\x96\xaa\xe7\x9a\x84\xe5\x91\xa8\xe6\x9c\x88\xe8\x96\xaa\xe5\x90\x8d\xe5\x8d\x95\xe8\xa1\xa5\xe5\x85\x85\xe5\x85\xa5\xe8\x81\x8c\xe7\x8a\xb6\xe6\x80\x81, \xe6\x9c\x88+\xe5\x91\xa8\xe8\xb4\xa6\xe5\x8d\x95\xe9\x87\x8c\xe5\xad\x98\xe5\x9c\xa8\xe7\x9a\x84\xef\xbc\x8c\xe5\xb0\xb1\xe6\x98\xaf\xe5\x9c\xa8\xe8\x81\x8c\xef\xbc\x8c\xe6\xb2\xa1\xe6\x9c\x89\xe7\x9a\x84\xe5\xb0\xb1\xe6\x98\xaf\xe7\xa6\xbb\xe8\x81\x8c'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n            update jff_ent_tmp.zhouxinxin_league_name_list a\n    inner join (\n    \tselect ent_id, if(work_card_no='', null, work_card_no) as work_card_num, id_card_num, entry_dt as entry_date, leave_dt as leave_date,\n    \tif(@entry_dt=temp.entry_dt and @id_card_num=temp.id_card_num, @rank := @rank+1, @rank := 1) as rank,\n    \t@entry_dt := temp.entry_dt, @id_card_num := temp.id_card_num\n    \tfrom (\n    \t\tSELECT upper(id_card_num) as id_card_num, work_card_no, entry_dt, ent_id, max(leave_dt) as leave_dt, count(1) as num\n    \t\tFROM `ods_zxx_2.0`.bill_weekly_batch_import_detail\n    \t\twhere entry_dt > '1970-01-01'\n    \t\tgroup by ent_id, upper(id_card_num), work_card_no, entry_dt\n    \t\torder by ent_id, id_card_num, entry_dt, num desc\n    \t)temp,\n    \t(select @entry_dt := null, @id_card_num := null, @rank := 0) r\n    ) b on b.rank = 1 and a.id_card_num = b.id_card_num and coalesce(a.fixed_work_card_num, a.work_card_num) = b.work_card_num\n    set a.hire_status = 1\n    where a.interview_date >= '${MIN_INTV_DT}';\n\n    update jff_ent_tmp.zhouxinxin_league_name_list\n    set hire_status = 0\n    where hire_status is null\n    and interview_date >= '${MIN_INTV_D}' "}, 2: {'color': 'blue', 'name': '#meta96', 'desc': u'\u8868 | ( SELECT ent_id if #meta88 AS work_card_num id_card_num entry_dt AS entry_date leave_dt AS leave_date if #meta89 AS rank @entry_dt := temp.entry_dt @id_card_num := temp.id_card_num FROM #meta94 TEMP #meta95 r )'}, 3: {'color': 'blue', 'name': '#meta94', 'desc': u"\u8868 | ( SELECT upper #meta90 AS id_card_num work_card_no entry_dt ent_id max #meta91 AS leave_dt count #meta92 AS num FROM `ods_zxx_2.0`.bill_weekly_batch_import_detail WHERE entry_dt > '1970 - 01 - 01' GROUP BY ent_id upper #meta93 work_card_no entry_dt ORDER BY ent_id id_card_num entry_dt num DESC )"}, 4: {'color': 'blue', 'name': '#meta95', 'desc': u'\u8868 | ( SELECT @entry_dt := NULL @id_card_num := NULL @rank := 0 )'}, 5: {'color': 'blue', 'name': u'`ods_zxx_2.0`.bill_weekly_batch_import_detail', 'desc': '\xe8\xa1\xa8'}, 6: {'color': 'orange', 'name': '#meta90', 'desc': u'\u5b57\u6bb5 | upper ( id_card_num ) '}, 7: {'color': 'orange', 'name': '#meta91', 'desc': u'\u5b57\u6bb5 | max ( leave_dt ) '}, 8: {'color': 'orange', 'name': '#meta92', 'desc': u'\u5b57\u6bb5 | count ( 1 ) '}, 9: {'color': 'orange', 'name': u'@id_card_num := temp.id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 10: {'color': 'orange', 'name': u'@id_card_num := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 11: {'color': 'orange', 'name': '#meta89', 'desc': u'\u5b57\u6bb5 | if ( @entry_dt = temp.entry_dt AND @id_card_num = temp.id_card_num @rank := @rank + 1 @rank := 1 ) '}, 12: {'color': 'orange', 'name': '#meta88', 'desc': u"\u5b57\u6bb5 | if ( work_card_no = '' NULL work_card_no ) "}, 13: {'color': 'orange', 'name': u'@entry_dt := NULL', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 14: {'color': 'orange', 'name': u'work_card_no', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 15: {'color': 'orange', 'name': u'entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 16: {'color': 'orange', 'name': u'@entry_dt := temp.entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 17: {'color': 'orange', 'name': u'ent_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 18: {'color': 'orange', 'name': u'@rank := 0', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 19: {'color': 'pink', 'name': u'id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 20: {'color': 'pink', 'name': u'leave_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 21: {'color': 'pink', 'name': u'num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 22: {'color': 'pink', 'name': u'rank', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 23: {'color': 'pink', 'name': u'work_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 24: {'color': 'pink', 'name': u'leave_date', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 25: {'color': 'pink', 'name': u'entry_date', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n6 >> 19\n7 >> 20\n8 >> 21\n11 >> 22\n12 >> 23\n20 >> 24\n15 >> 25\n5 >> 6\n5 >> 7\n5 >> 8\n2 >> 9\n4 >> 10\n2 >> 11\n2 >> 12\n4 >> 13\n5 >> 14\n5 >> 15\n2 >> 16\n5 >> 17\n4 >> 18\n2 >> 3\n2 >> 4\n1 >> 2\n3 >> 5', 'title': '2.2 \xe6\xa0\xb9\xe6\x8d\xae\xe5\x91\xa8\xe8\x96\xaa\xe8\x96\xaa\xe7\x9a\x84\xe5\x91\xa8\xe6\x9c\x88\xe8\x96\xaa\xe5\x90\x8d\xe5\x8d\x95\xe8\xa1\xa5\xe5\x85\x85\xe5\x85\xa5\xe8\x81\x8c\xe7\x8a\xb6\xe6\x80\x81, \xe6\x9c\x88+\xe5\x91\xa8\xe8\xb4\xa6\xe5\x8d\x95\xe9\x87\x8c\xe5\xad\x98\xe5\x9c\xa8\xe7\x9a\x84\xef\xbc\x8c\xe5\xb0\xb1\xe6\x98\xaf\xe5\x9c\xa8\xe8\x81\x8c\xef\xbc\x8c\xe6\xb2\xa1\xe6\x9c\x89\xe7\x9a\x84\xe5\xb0\xb1\xe6\x98\xaf\xe7\xa6\xbb\xe8\x81\x8c'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': '\n            insert data into jff_cb_name_list\xef\xbc\x9a\n    SELECT distinct a.name_list_id, a.mbr_id_card_num,\n    c.sp_id,  a.intv_dt, a.rcrt_typ,\n    a.intv_sts, b.hire_status\n    FROM `ods_jff`.name_list a\n    left join ods_jff.league_store c on a.sp_id = c.sp_id\n    left join jff_ent_tmp.zhouxinxin_league_name_list b\n    on upper(a.mbr_id_card_num)=b.id_card_num and a.intv_dt=b.interview_date\n    where a.intv_dt >= c.coop_start_dt\n    and a.intv_dt <= CURRENT_DATE\n    and c.sp_id != 1006 and a.is_deleted = 0; '}, 2: {'color': 'blue', 'name': u'`ods_jff`.name_list', 'desc': '\xe8\xa1\xa8'}, 3: {'color': 'blue', 'name': u'ods_jff.league_store', 'desc': '\xe8\xa1\xa8'}, 4: {'color': 'blue', 'name': u'jff_ent_tmp.zhouxinxin_league_name_list', 'desc': '\xe8\xa1\xa8'}, 5: {'color': 'orange', 'name': u'hire_status', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 6: {'color': 'orange', 'name': u'intv_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 7: {'color': 'orange', 'name': u'sp_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 8: {'color': 'orange', 'name': u'intv_sts', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 9: {'color': 'orange', 'name': u'name_list_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 10: {'color': 'orange', 'name': u'rcrt_typ', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 11: {'color': 'orange', 'name': u'mbr_id_card_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n4 >> 5\n2 >> 6\n3 >> 7\n2 >> 8\n2 >> 9\n2 >> 10\n2 >> 11\n1 >> 2\n1 >> 3\n1 >> 4', 'title': '3 \xe6\x8a\xbd\xe5\x8f\x96\xe5\xad\x97\xe6\xae\xb5\xe7\x94\x9f\xe6\x88\x90\xe7\xae\x80\xe6\x98\x93\xe5\x8a\xa0\xe7\x9b\x9f\xe5\xba\x97\xe5\x90\x8d\xe5\x8d\x95jff_ent_tmp.jff_cb_name_list'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n            select intv_dt, DATE_FORMAT(intv_dt, '%Y-%m') as interview_month,\n    count(*) as d_total,\n    count(rcrt_typ=2 or null) as d_zxx_total,\n    count(intv_sts=2 or null) as d_intv,\n    count(rcrt_typ=2 and intv_sts=2 or null) as d_zxx_intv,\n    count(rcrt_typ=2 and intv_sts=2 and hire_status=1 or null) as d_zxx_hire,\n    count(rcrt_typ=0 or null) as d_nzxx_total,\n    count(rcrt_typ=0 and intv_sts=2 or null) as d_nzxx_intv\n    from jff_ent_tmp.jff_cb_name_list\n    group by intv_dt "}, 2: {'color': 'blue', 'name': u'jff_ent_tmp.jff_cb_name_list', 'desc': '\xe8\xa1\xa8'}, 3: {'color': 'orange', 'name': '#meta99', 'desc': u"\u5b57\u6bb5 | DATE_FORMAT ( intv_dt '%Y - %m' ) "}, 4: {'color': 'orange', 'name': u'intv_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 5: {'color': 'orange', 'name': '#meta105', 'desc': u'\u5b57\u6bb5 | count ( rcrt_typ = 0 OR NULL ) '}, 6: {'color': 'orange', 'name': '#meta104', 'desc': u'\u5b57\u6bb5 | count ( rcrt_typ = 2 AND intv_sts = 2 AND hire_status = 1 OR NULL ) '}, 7: {'color': 'orange', 'name': '#meta106', 'desc': u'\u5b57\u6bb5 | count ( rcrt_typ = 0 AND intv_sts = 2 OR NULL ) '}, 8: {'color': 'orange', 'name': '#meta101', 'desc': u'\u5b57\u6bb5 | count ( rcrt_typ = 2 OR NULL ) '}, 9: {'color': 'orange', 'name': '#meta100', 'desc': u'\u5b57\u6bb5 | count ( * ) '}, 10: {'color': 'orange', 'name': '#meta103', 'desc': u'\u5b57\u6bb5 | count ( rcrt_typ = 2 AND intv_sts = 2 OR NULL ) '}, 11: {'color': 'orange', 'name': '#meta102', 'desc': u'\u5b57\u6bb5 | count ( intv_sts = 2 OR NULL ) '}, 12: {'color': 'pink', 'name': u'interview_month', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}, 14: {'color': 'pink', 'name': u'd_zxx_hire', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 13: {'color': 'pink', 'name': u'd_nzxx_total', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 16: {'color': 'pink', 'name': u'd_zxx_total', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 17: {'color': 'pink', 'name': u'd_total', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 18: {'color': 'pink', 'name': u'd_zxx_intv', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 19: {'color': 'pink', 'name': u'd_intv', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 15: {'color': 'pink', 'name': u'd_nzxx_intv', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}}, 'dag': 'ts >> 1 \n3 >> 12\n5 >> 13\n6 >> 14\n7 >> 15\n8 >> 16\n9 >> 17\n10 >> 18\n11 >> 19\n2 >> 3\n2 >> 4\n2 >> 5\n2 >> 6\n2 >> 7\n2 >> 8\n2 >> 9\n2 >> 10\n2 >> 11\n1 >> 2', 'title': '4 \xe7\x94\x9f\xe6\x88\x90\xe7\xbb\x9f\xe8\xae\xa1\xe7\xbb\x93\xe6\x9e\x9c'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n            select\n    count(distinct vIDCardNum) as cnt\n    from\n    ods_woda.tbbrokeruserorderstatus ta\n    where\n    eStatus=1\n    and dtcheckintime>=%s\n    and dtcheckintime<%s\n    and  iCheckinRecruitTmpID in (\n            select iRecruitTmpID from ods_woda.tbRecruitTmp where vPositionName like '%%\xe5\x91\xa8\xe8\x96\xaa\xe8\x96\xaa%%' and eStatus=1\n    )\n    and eInterviewStatus in(1,2)\n    and eJFFInterviewStatus=2\n    and exists(\n    select\n    mbr_id_card_num\n    from\n    ods_jff.name_list\n    where\n    intv_dt>=%s\n    and intv_dt<%s\n    and rcrt_typ=1\n    and is_deleted=0\n    and left(ta.dtCheckinTime,10) = intv_dt\n    and ta.vIDCardNum = mbr_id_card_num\n    )"}, 2: {'color': 'blue', 'name': u'ods_woda.tbbrokeruserorderstatus', 'desc': '\xe8\xa1\xa8'}, 3: {'color': 'orange', 'name': '#meta107', 'desc': u'\u5b57\u6bb5 | count ( vIDCardNum ) '}, 4: {'color': 'pink', 'name': u'cnt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n3 >> 4\n2 >> 3\n1 >> 2', 'title': '4 \xe7\x94\x9f\xe6\x88\x90\xe7\xbb\x9f\xe8\xae\xa1\xe7\xbb\x93\xe6\x9e\x9c'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': '\n        select sum(tta.m),sum(tta.days) ,\nsum(tta.m)/sum(tta.days),\nleft(entry_dt,7) as month\nfrom\n(\nselect\nbegin_dt,end_dt,entry_dt,leave_dt,\ncase when entry_dt>end_dt then 0\nwhen entry_dt>=begin_dt and end_dt<=leave_dt and leave_dt is not null then datediff(end_dt,entry_dt)\nwhen entry_dt>=begin_dt and leave_dt is null then datediff(end_dt,entry_dt)\nwhen entry_dt>=begin_dt and end_dt>=leave_dt and   leave_dt is not null  then datediff(end_dt,entry_dt)\nwhen entry_dt<begin_dt and end_dt<=leave_dt and leave_dt is not null then datediff(end_dt,begin_dt)\nwhen entry_dt<begin_dt and leave_dt is null then datediff(end_dt,begin_dt)\nwhen entry_dt<begin_dt and end_dt>=leave_dt and  leave_dt is not null then datediff(leave_dt,begin_dt)\nend +1 as `days`,agent_amt/100 as `m`\nfrom league_bill\nwhere\nstore_sp_id!=1006\n) tta\ngroup by left(entry_dt,7);\n        '}, 2: {'color': 'blue', 'name': '#meta124', 'desc': u'\u8868 | ( SELECT begin_dt end_dt entry_dt leave_dt #meta125 + 1 AS `days` agent_amt / 100 AS `m` FROM league_bill WHERE store_sp_id! = 1006 )'}, 3: {'color': 'blue', 'name': u'league_bill', 'desc': '\xe8\xa1\xa8'}, 4: {'color': 'orange', 'name': u'agent_amt / 100', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 5: {'color': 'orange', 'name': u'leave_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 6: {'color': 'orange', 'name': '#meta113', 'desc': u'\u5b57\u6bb5 | sum ( tta.m ) '}, 7: {'color': 'orange', 'name': u'begin_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 8: {'color': 'orange', 'name': u'entry_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 9: {'color': 'orange', 'name': '#meta117', 'desc': u'\u5b57\u6bb5 | left ( entry_dt 7 ) '}, 10: {'color': 'orange', 'name': '#meta114', 'desc': u'\u5b57\u6bb5 | sum ( tta.days ) '}, 11: {'color': 'orange', 'name': '#meta115', 'desc': u'\u5b57\u6bb5 | sum ( tta.m ) / sum ( tta.days ) '}, 12: {'color': 'orange', 'name': '#meta125', 'desc': u'\u5b57\u6bb5 | CASE WHEN entry_dt>end_dt THEN 0 WHEN entry_dt> = begin_dt AND end_dt< = leave_dt AND leave_dt IS NOT NULL THEN datediff ( end_dt entry_dt ) WHEN entry_dt> = begin_dt AND leave_dt IS NULL THEN datediff ( end_dt entry_dt ) WHEN entry_dt> = begin_dt AND end_dt> = leave_dt AND leave_dt IS NOT NULL THEN datediff ( end_dt entry_dt ) WHEN entry_dt<begin_dt AND end_dt< = leave_dt AND leave_dt IS NOT NULL THEN datediff ( end_dt begin_dt ) WHEN entry_dt<begin_dt AND leave_dt IS NULL THEN datediff ( end_dt begin_dt ) WHEN entry_dt<begin_dt AND end_dt> = leave_dt AND leave_dt IS NOT NULL THEN datediff ( leave_dt begin_dt ) END + 1 '}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}, 14: {'color': 'pink', 'name': u'`m`', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 13: {'color': 'orange', 'name': u'end_dt', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 16: {'color': 'pink', 'name': u'MONTH', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 15: {'color': 'pink', 'name': u'`days`', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}}, 'dag': 'ts >> 1 \n4 >> 14\n12 >> 15\n9 >> 16\n3 >> 4\n3 >> 5\n2 >> 6\n3 >> 7\n3 >> 8\n2 >> 9\n2 >> 10\n2 >> 11\n3 >> 12\n3 >> 13\n1 >> 2\n2 >> 3', 'title': '\xe6\xb5\x8b\xe8\xaf\x95'},
 {'nodes': {1: {'color': 'lightblue', 'name': 'SQL', 'desc': "\n        select a.mgmt_city_name as \xe5\x8c\xba\xe5\x9f\x9f, a.league_name as \xe9\x97\xa8\xe5\xba\x97\xe5\x90\x8d\xe7\xa7\xb0, a.enroll_cnt as \xe9\xa2\x84\xe7\xad\xbe\xe5\x88\xb0\xe6\x95\xb0, a.broker_cnt as \xe7\xbb\x8f\xe7\xba\xaa\xe4\xba\xba\xe6\x95\xb0, a.avg_cnt as \xe4\xba\xba\xe5\x9d\x87, a.row_num as \xe6\x8e\x92\xe5\x90\x8d from (\nselect x.*, (@row_num:=@row_num+1) as row_num from\n(\nSELECT c.mgmt_city_name, c.league_id, c.league_name, count(a.broker_enroll_id) as enroll_cnt, c.cnt as broker_cnt, count(a.broker_enroll_id)/c.cnt as avg_cnt\nfrom (\n\tselect d.league_id, count(distinct b.user_id) as cnt, d.mgmt_city_name, d.league_name\n\tfrom league_broker  a, league_store_broker  b, user  c, league_store  d\n\twhere a.broker_id=b.broker_id and b.user_id=c.user_id and c.trgt_id=d.sp_id\n\tand a.entry_status=0 and a.is_deleted=0 and b.is_enabled=1 and b.is_deleted=0 and c.is_deleted=0 and c.is_enabled=1 and d.is_deleted=0\n    and d.league_id in (1146,1128,1137,1138,1142,1144,1093,1101,1121,1125,1143,1145,1083,1129,1107,1102,1085,1136,1139,1065,1068,1090,1054,1091,1002,1045)\n\tgroup by league_store_id, d.mgmt_city_name, d.league_name\n) c left join broker_enroll  a on\na.is_deleted = 0 and a.enroll_dt = DATE_ADD(current_date, INTERVAL 1 DAY) and a.created_tm >= CURRENT_DATE and a.store_league_id=c.league_id\nGROUP BY c.mgmt_city_name, c.league_name\norder by avg_cnt desc\n) x, (select (@row_num :=0) ) y\n) a\norder by find_in_set(a.league_id, '1146,1128,1137,1138,1142,1144,1093,1101,1121,1125,1143,1145,1083,1129,1107,1102,1085,1136,1139,1065,1068,1090,1054,1091,1002,1045');\n        "}, 2: {'color': 'blue', 'name': '#meta137', 'desc': u'\u8868 | ( SELECT x.* #meta127 AS row_num FROM #meta134 x #meta136 y )'}, 3: {'color': 'blue', 'name': '#meta134', 'desc': u'\u8868 | ( SELECT c.mgmt_city_name c.league_id c.league_name count #meta128 AS enroll_cnt c.cnt AS broker_cnt count #meta129 / c.cnt AS avg_cnt FROM #meta132 c JOIN broker_enroll a ON a.is_deleted = 0 AND a.enroll_dt = DATE_ADD #meta133 AND a.created_tm > = CURRENT_DATE AND a.store_league_id = c.league_id GROUP BY c.mgmt_city_name c.league_name ORDER BY avg_cnt DESC )'}, 4: {'color': 'blue', 'name': '#meta136', 'desc': u'\u8868 | ( SELECT #meta135 )'}, 5: {'color': 'blue', 'name': '#meta132', 'desc': u'\u8868 | ( SELECT d.league_id count #meta130 AS cnt d.mgmt_city_name d.league_name FROM league_broker a league_store_broker b USER c league_store d WHERE a.broker_id = b.broker_id AND b.user_id = c.user_id AND c.trgt_id = d.sp_id AND a.entry_status = 0 AND a.is_deleted = 0 AND b.is_enabled = 1 AND b.is_deleted = 0 AND c.is_deleted = 0 AND c.is_enabled = 1 AND d.is_deleted = 0 AND d.league_id IN #meta131 GROUP BY league_store_id d.mgmt_city_name d.league_name )'}, 6: {'color': 'blue', 'name': u'broker_enroll', 'desc': '\xe8\xa1\xa8'}, 7: {'color': 'blue', 'name': u'league_broker', 'desc': '\xe8\xa1\xa8'}, 8: {'color': 'blue', 'name': u'league_store_broker', 'desc': '\xe8\xa1\xa8'}, 9: {'color': 'blue', 'name': u'USER', 'desc': '\xe8\xa1\xa8'}, 10: {'color': 'blue', 'name': u'league_store', 'desc': '\xe8\xa1\xa8'}, 11: {'color': 'orange', 'name': u'mgmt_city_name', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 12: {'color': 'orange', 'name': u'league_id', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 13: {'color': 'orange', 'name': u'*', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 14: {'color': 'orange', 'name': u'league_name', 'desc': '\xe5\xad\x97\xe6\xae\xb5'}, 15: {'color': 'orange', 'name': '#meta129', 'desc': u'\u5b57\u6bb5 | count ( a.broker_enroll_id ) / c.cnt '}, 16: {'color': 'orange', 'name': '#meta128', 'desc': u'\u5b57\u6bb5 | count ( a.broker_enroll_id ) '}, 17: {'color': 'orange', 'name': '#meta127', 'desc': u'\u5b57\u6bb5 | ( @row_num := @row_num + 1 ) '}, 18: {'color': 'orange', 'name': '#meta135', 'desc': u'\u5b57\u6bb5 | ( @row_num := 0 ) '}, 19: {'color': 'orange', 'name': '#meta130', 'desc': u'\u5b57\u6bb5 | count ( b.user_id ) '}, 20: {'color': 'pink', 'name': u'\u533a\u57df', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 21: {'color': 'pink', 'name': u'\u6392\u540d', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 22: {'color': 'pink', 'name': u'\u4eba\u5747', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 23: {'color': 'pink', 'name': u'broker_cnt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 24: {'color': 'pink', 'name': u'\u7ecf\u7eaa\u4eba\u6570', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 25: {'color': 'pink', 'name': u'\u95e8\u5e97\u540d\u79f0', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 26: {'color': 'pink', 'name': u'avg_cnt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 27: {'color': 'pink', 'name': u'enroll_cnt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 28: {'color': 'pink', 'name': u'row_num', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 29: {'color': 'pink', 'name': u'cnt', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 30: {'color': 'pink', 'name': u'\u9884\u7b7e\u5230\u6570', 'desc': '\xe5\xad\x97\xe6\xae\xb5\xe5\x88\xab\xe5\x90\x8d'}, 'ts': {'color': 'red', 'name': '\xe5\xbc\x80\xe5\xa7\x8b', 'desc': '\xe5\xbc\x80\xe5\xa7\x8b'}}, 'dag': 'ts >> 1 \n11 >> 20\n28 >> 21\n26 >> 22\n29 >> 23\n23 >> 24\n14 >> 25\n15 >> 26\n16 >> 27\n17 >> 28\n19 >> 29\n27 >> 30\n10 >> 11\n10 >> 12\n3 >> 13\n10 >> 14\n3 >> 15\n3 >> 16\n2 >> 17\n4 >> 18\n5 >> 19\n5 >> 7\n5 >> 8\n3 >> 6\n5 >> 9\n2 >> 3\n5 >> 10\n2 >> 4\n1 >> 2\n3 >> 5', 'title': '\xe6\x9c\xb1\xe9\x9b\xa8\xe6\xb5\x8b\xe8\xaf\x95SQL'},]
